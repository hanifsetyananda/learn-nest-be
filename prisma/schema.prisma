generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Buku {
  id          Int          @id @default(autoincrement())
  judul       String
  penulis     String
  deskripsi   String       @db.Text
  foto        String
  status      StatusBuku   @default(AVAILABLE)
  createdBy   User?         @relation(fields: [createdById], references: [id])
  createdById Int?
  peminjaman  Peminjaman[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

enum StatusBuku {
  AVAILABLE
  BORROWED
}

model User {
  id         Int          @id @default(autoincrement())
  name       String?
  email      String       @unique
  password   String
  role       Role         @default(USER)
  buku       Buku[]
  peminjaman Peminjaman[]
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
}

enum Role {
  ADMIN
  USER
}

model Peminjaman {
  id                Int              @id @default(autoincrement())
  buku              Buku             @relation(fields: [bukuId], references: [id], onDelete: Cascade)
  bukuId            Int
  user              User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId            Int
  tanggalPinjam     DateTime
  tanggalJatuhTempo DateTime
  tanggalKembali    DateTime?
  status            StatusPeminjaman @default(BORROWED)
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
}

enum StatusPeminjaman {
  BORROWED
  RETURNED
}
